---
description:
globs:
alwaysApply: true
---
# Soybean Primitives Repository Guide

You are working with **Soybean Primitives**, a Vue 3 headless UI component library. This guide helps you quickly understand the repository structure and architecture.

## ğŸ—ï¸ Project Overview

**Soybean Primitives** is a collection of primitive headless UI components for Vue 3, designed to be lightweight, accessible, and highly customizable.

- **Framework**: Vue 3 with Composition API
- **Language**: TypeScript (strict mode)
- **Build System**: tsdown + Vite
- **Package Manager**: pnpm
- **Styling**: UnoCSS + CSS Variables
- **Testing**: Vitest
- **Architecture**: Headless UI Components (no built-in styling)

## ğŸ“ Repository Structure

```
soybean-primitives/
â”œâ”€â”€ ğŸ“¦ src/                           # Source code
â”‚   â”œâ”€â”€ ğŸ§© components/                # Component library
â”‚   â”‚   â”œâ”€â”€ accordion/                # Accordion component suite
â”‚   â”‚   â”œâ”€â”€ collapsible/              # Collapsible component
â”‚   â”‚   â”œâ”€â”€ config-provider/          # Configuration provider
â”‚   â”‚   â”œâ”€â”€ portal/                   # Portal/Teleport component
â”‚   â”‚   â”œâ”€â”€ primitive/                # Base primitive component
â”‚   â”‚   â””â”€â”€ slot/                     # Slot utilities
â”‚   â”œâ”€â”€ ğŸ”§ composables/               # Vue 3 composables
â”‚   â”œâ”€â”€ ğŸ¨ shared/                    # Shared utilities
â”‚   â”œâ”€â”€ ğŸ“ types/                     # TypeScript type definitions
â”‚   â”œâ”€â”€ ğŸ”¢ constants/                 # Global constants
â”‚   â”œâ”€â”€ ğŸ”Œ resolver/                  # Component resolver
â”‚   â”œâ”€â”€ ğŸš€ nuxt/                      # Nuxt integration
â”‚   â””â”€â”€ index.ts                      # Main export entry
â”œâ”€â”€ ğŸ® playground/                    # Development playground
â”œâ”€â”€ ğŸ“š typings/                       # Global type declarations
â”œâ”€â”€ âš™ï¸ Configuration files
â”‚   â”œâ”€â”€ package.json                  # Project metadata & dependencies
â”‚   â”œâ”€â”€ tsconfig.json                 # TypeScript configuration
â”‚   â”œâ”€â”€ vite.config.ts               # Vite configuration
â”‚   â”œâ”€â”€ vitest.config.ts             # Test configuration
â”‚   â”œâ”€â”€ uno.config.ts                # UnoCSS configuration
â”‚   â”œâ”€â”€ tsdown.config.ts             # Build configuration
â”‚   â””â”€â”€ eslint.config.js             # ESLint configuration
â””â”€â”€ ğŸ“„ Documentation
    â”œâ”€â”€ README.md                     # Project documentation
    â””â”€â”€ CHANGELOG.md                  # Version changelog
```

## ğŸ§© Component Architecture

Each component follows a **standardized structure**:

```
src/components/{component-name}/
â”œâ”€â”€ index.ts                    # Export entry point
â”œâ”€â”€ types.ts                    # TypeScript definitions
â”œâ”€â”€ context.ts                  # Vue provide/inject context
â”œâ”€â”€ shared.ts                   # Component-specific utilities
â”œâ”€â”€ {component}-root.vue        # Root component
â”œâ”€â”€ {component}-item.vue        # Sub-components
â””â”€â”€ {component}-*.vue           # Additional sub-components
```

### Component Design Principles
- **Headless**: No built-in styling, maximum customization
- **Accessible**: Full ARIA support and keyboard navigation
- **Composable**: Built with Vue 3 Composition API
- **Type-safe**: Complete TypeScript coverage
- **Context-aware**: Uses provide/inject for component communication

## ğŸ”§ Key Directories Explained

### `/src/components/`
Contains all UI components. Each component is a **complete suite** with multiple sub-components:
- **accordion**: Collapsible content panels
- **collapsible**: Basic show/hide functionality
- **config-provider**: Global configuration context
- **portal**: Render content in different DOM locations
- **primitive**: Base component for building others
- **slot**: Slot composition utilities

### `/src/composables/`
Vue 3 composables providing reusable logic:
- `use-context.ts` - Provide/inject context management
- `use-v-model.ts` - v-model binding utilities
- `use-arrow-navigation.ts` - Keyboard navigation
- `use-focus-scope.ts` - Focus management
- `use-dismissable-layer.ts` - Click-outside detection
- `use-presence.ts` - Enter/exit animations

### `/src/shared/`
Common utilities and helpers:
- `common.ts` - General utility functions
- `vue.ts` - Vue-specific helpers
- `dom.ts` - DOM manipulation utilities
- `focus.ts` - Focus management helpers
- `event.ts` - Event handling utilities

### `/src/types/`
Global TypeScript type definitions for the entire library.

## ğŸ› ï¸ Development Workflow

### Available Scripts
```bash
# Development
pnpm dev          # Build library in watch mode
pnpm play         # Start playground development server

# Building
pnpm build        # Build production bundle
pnpm typecheck    # TypeScript type checking

# Testing & Quality
pnpm test         # Run test suite
pnpm lint         # ESLint code formatting

# Release
pnpm release      # Version bumping and release
pnpm publish-pkg  # Publish to npm
```

### Package Export Structure
The library exports components in multiple ways:
- **Main export**: `import { AccordionRoot } from 'soybean-primitives'`
- **Individual exports**: `import { AccordionRoot } from 'soybean-primitives/accordion'`
- **Composables**: `import { useContext } from 'soybean-primitives/composables'`
- **Types**: `import type { ClassValueProp } from 'soybean-primitives'`

## ğŸ¯ Code Patterns

### Component Structure Pattern
```vue
<script setup lang="ts">
// 1. Imports (Vue, composables, types)
// 2. Props/Emits definitions
// 3. Template refs
// 4. Composable usage
// 5. Context provision/consumption
</script>

<template>
  <!-- Semantic HTML with data attributes for styling hooks -->
</template>
```

### Type Definition Pattern
```typescript
// Props interface (extends ClassValueProp)
export interface ComponentProps extends ClassValueProp {
  // JSDoc with @defaultValue
}

// Emits type
export type ComponentEmits = {
  'update:modelValue': [value: string];
};

// Context interface
export interface ComponentContextParams {
  // Context state and methods
}
```

## ğŸ” Quick Navigation Tips

- **Adding new component**: Follow existing component structure in `/src/components/`
- **Need composable**: Check `/src/composables/` first, then create new one
- **Type definitions**: Global types in `/src/types/`, component types in component's `types.ts`
- **Utilities**: Add to appropriate file in `/src/shared/`
- **Testing**: Component tests should test accessibility, keyboard navigation, and core functionality

## ğŸš€ Development Focus Areas

1. **Accessibility**: ARIA attributes, keyboard navigation, focus management
2. **Type Safety**: Complete TypeScript coverage with strict mode
3. **Performance**: Efficient composables, computed properties, minimal re-renders
4. **Developer Experience**: Clear APIs, good TypeScript intellisense, helpful error messages
5. **Customization**: CSS variables, data attributes, unstyled components

This repository structure supports building robust, accessible, and highly customizable UI components for Vue 3 applications.
